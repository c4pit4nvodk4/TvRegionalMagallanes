<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<title>TV Regional Magallanes</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<script src="https://cdn.jsdelivr.net/npm/hls.js@latest"></script>

<style>
html, body {
  margin: 0;
  padding: 0;
  background: black;
  height: 100%;
  overflow: hidden;
}

video {
  width: 100vw;
  height: 100vh;
  object-fit: contain;
  background: black;
}

#info {
  position: absolute;
  bottom: 5%;
  left: 5%;
  display: flex;
  align-items: center;
  gap: 15px;
  background: rgba(0,0,0,0.6);
  padding: 15px 20px;
  border-radius: 10px;
  color: white;
  font-family: Arial, sans-serif;
  opacity: 0;
  transition: opacity 0.3s;
}

#info img {
  width: 60px;
  height: auto;
}

#info span {
  font-size: 18px;
}
</style>
</head>

<body>

<video id="player" autoplay playsinline></video>

<div id="info">
  <img id="logo">
  <span id="text"></span>
</div>

<script>
const canales = [
  {
    numero: 0,
    nombre: "TV Regional Magallanes",
    logo: "https://c4pit4nvodk4.github.io/TvRegionalMagallanes/LOGOS/LOGO.png",
    url: "https://c4pit4nvodk4.github.io/TvRegionalMagallanes/Trailer.webm",
    loop: true
  },
  {
    numero: 1,
    nombre: "UMAG TV",
    logo: "LOGOS/UMAGTV2.png",
    url: "https://tls-cl.cdnz.cl/umag2/live/playlist.m3u8"
  },
  {
    numero: 2,
    nombre: "SUR TV",
    logo: "LOGOS/SURTV.png",
    url: "https://redirector.rudo.video/hls-video/ey6283je82983je9823je8jowowiekldk9838274/surtv/surtv.smil/playlist.m3u8?did="
  },
  {
    numero: 3,
    nombre: "Eva Visión",
    logo: "LOGOS/EVAVISION.png",
    url: "https://stmv4.voxtvhd.com.br/evavision/evavision/playlist.m3u8"
  },
  {
    numero: 4,
    nombre: "Eva Retro",
    logo: "LOGOS/EVAVISIONRETRO.png",
    url: "https://premium.tvcontrolcp.com:1936/evaretro/evaretro/playlist.m3u8"
  },
  {
    numero: 5,
    nombre: "Patagonia TV",
    logo: "LOGOS/PATAGONIATV.png",
    url: "https://videohd.live:19360/8100/8100.m3u8"
  },
  {
    numero: 6,
    nombre: "Canal Sur Patagonia",
    logo: "LOGOS/CANALSURPATAGONIA.png",
    url: "https://v2.tustreaming.cl/fmarcoirirs/tracks-v1a1/playlist.m3u8?PlaylistM3UCL"
  },
  {
    numero: 7,
    nombre: "Red Fueguina",
    logo: "LOGOS/redfueguinamedios.png",
    url: "https://stmv5.voxtvhd.com.br/redfueguina/redfueguina/playlist.m3u8"
  },
  {
    numero: 8,
    nombre: "Radio Navarino",
    logo: "LOGOS/RADIONAVARINO.png",
    url: "https://panel.tvstream.cl:1936/matxnmjryy/matxnmjryy/playlist.m3u8"
  },
  {
    numero: 9,
    nombre: "Mega",
    logo: "https://cdn.m3u.cl/logo/455_Mega.png",
    url: "https://unlimited1-cl-isp.dps.live/mega/mega.smil/playlist.m3u8?PlaylistM3UCL"
  },
  {
    numero: 10,
    nombre: "CHV",
    logo: "https://cdn.m3u.cl/logo/1153_CHV.png",
    url: "https://mdstrm.com/live-stream-playlist/6491ced935a5833c47dd7f41.m3u8?PlaylistM3UCL"
  },
  {
    numero: 11,
    nombre: "Canal 13",
    logo: "https://cdn.m3u.cl/logo/457_Canal_13.png",
    url: "https://m3u.cl/channel/c13.php?PlaylistM3UCL"
  }
];

let index = 0;
let hls;
const video = document.getElementById("player");

function cargarCanal(i) {
  index = (i + canales.length) % canales.length;
  const c = canales[index];

  if (hls) hls.destroy();
  video.pause();
  video.loop = c.loop || false;

  if (c.url.endsWith(".webm")) {
    video.src = c.url;
  } else if (Hls.isSupported()) {
    hls = new Hls();
    hls.loadSource(c.url);
    hls.attachMedia(video);
  } else {
    video.src = c.url;
  }

  video.play();
  mostrarInfo(c);
}

function mostrarInfo(c) {
  const info = document.getElementById("info");
  document.getElementById("logo").src = c.logo;
  document.getElementById("text").innerText = `${c.numero} - ${c.nombre}`;
  info.style.opacity = 1;
  setTimeout(() => info.style.opacity = 0, 2500);
}

// TECLADO / CONTROL
let buffer = "";
document.addEventListener("keydown", e => {
  if (e.key === "ArrowUp") cargarCanal(index + 1);
  if (e.key === "ArrowDown") cargarCanal(index - 1);
  if (e.key === "+") video.volume = Math.min(1, video.volume + 0.1);
  if (e.key === "-") video.volume = Math.max(0, video.volume - 0.1);

  if (!isNaN(e.key)) {
    buffer += e.key;
    clearTimeout(window.timer);
    window.timer = setTimeout(() => {
      const num = parseInt(buffer);
      const i = canales.findIndex(c => c.numero === num);
      if (i >= 0) cargarCanal(i);
      buffer = "";
    }, 800);
  }
});

// GESTOS TÁCTILES
let startY = 0;
document.addEventListener("touchstart", e => startY = e.touches[0].clientY);
document.addEventListener("touchend", e => {
  const endY = e.changedTouches[0].clientY;
  if (startY - endY > 50) cargarCanal(index + 1);
  if (endY - startY > 50) cargarCanal(index - 1);
});

// INICIO
cargarCanal(0);
</script>

</body>
</html>
