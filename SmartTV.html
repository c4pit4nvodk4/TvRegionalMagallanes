<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>TV Regional Magallanes</title>
<link rel="icon" href="LOGOS/ICON.png">

<style>
html,body{
  margin:0;
  padding:0;
  width:100%;
  height:100%;
  background:black;
  overflow:hidden;
  font-family:Arial,Helvetica,sans-serif;
}

video{
  width:100%;
  height:100%;
  object-fit:contain;
  background:black;
}

#audioLogo{
  position:absolute;
  width:100%;
  height:100%;
  object-fit:contain;
  display:none;
}

/* ===== OVERLAY INFO ===== */
#overlay{
  position:absolute;
  bottom:20px;
  left:20px;
  background:rgba(0,0,0,.7);
  padding:15px;
  border-radius:14px;
  display:flex;
  align-items:center;
  gap:12px;
  opacity:0;
  transition:.5s;
}

#overlay.show{opacity:1;}

#overlay img{height:50px;}
#overlay .info{color:white;}
#overlay .info strong{font-size:18px;}
#overlay .info span{font-size:14px;opacity:.8;}

.separator{
  width:1px;
  height:50px;
  background:rgba(255,255,255,.3);
}

/* ===== LISTA DERECHA ===== */
#channelList{
  position:absolute;
  right:20px;
  top:50%;
  transform:translateY(-50%) translateX(120%);
  width:300px;
  max-height:75%;
  background:rgba(0,0,0,.75);
  border-radius:16px;
  overflow:hidden;
  opacity:0;
  transition:.4s;
}

#channelList.show{
  transform:translateY(-50%) translateX(0);
  opacity:1;
}

#channelItems{
  max-height:100%;
  overflow-y:auto;
}

.channel-item{
  display:flex;
  align-items:center;
  gap:10px;
  padding:10px;
  color:white;
  opacity:.6;
}

.channel-item img{height:34px;}
.channel-item span{font-size:14px;}

.channel-item.active{
  background:rgba(255,255,255,.15);
  opacity:1;
}
</style>
</head>

<body>

<video id="player" autoplay muted playsinline></video>
<img id="audioLogo">

<!-- Overlay info -->
<div id="overlay">
  <img id="overlayLogo">
  <div class="info">
    <strong id="overlayName"></strong><br>
    <span id="overlayNumber"></span>
  </div>
  <div class="separator"></div>
  <img src="LOGOS/ICON.png">
</div>

<!-- Lista derecha -->
<div id="channelList">
  <div id="channelItems"></div>
</div>

<script src="https://cdn.jsdelivr.net/npm/hls.js@latest"></script>
<script>
const video = document.getElementById("player");
const audioLogo = document.getElementById("audioLogo");

const overlay = document.getElementById("overlay");
const overlayLogo = document.getElementById("overlayLogo");
const overlayName = document.getElementById("overlayName");
const overlayNumber = document.getElementById("overlayNumber");

const channelList = document.getElementById("channelList");
const channelItems = document.getElementById("channelItems");

let currentChannel = 0;
let inputNumber = "";
let overlayTimeout, listTimeout;

/* ===== CANALES ===== */
const channels = [
{number:1,name:"TV Regional Magallanes",type:"video",url:"https://c4pit4nvodk4.github.io/TvRegionalMagallanes/Trailer.webm",logo:"LOGOS/ICON.png"},
{number:2,name:"Pingüino Multimedia",type:"m3u8",url:"https://redirector.rudo.video/hls-video/339f69c6122f6d8f4574732c235f09b7683e31a5/pinguinotv/pinguinotv.smil/playlist.m3u8",logo:"LOGOS/PINGUINOMULTIMEDIA.png"},
{number:3,name:"Radio Magallanes TV",type:"m3u8",url:"https://live20.bozztv.com/akamaissh101/ssh101/radiomagallanes/playlist.m3u8",logo:"LOGOS/RADIOMAGALLANES.png"},
{number:4,name:"Polar Comunicaciones",type:"m3u8",url:"https://polartv.webredirect.org/memfs/319ac83c-e602-4e91-8104-2b5501380b5e.m3u8",logo:"LOGOS/POLARCOMUNICACIONES.png"},
{number:5,name:"ITV Patagonia",type:"m3u8",url:"https://unlimited1-cl-isp.dps.live/itv/itv.smil/playlist.m3u8?PlaylistM3UCL",logo:"LOGOS/ITV.png"},
{number:6,name:"Soberanía TV",type:"m3u8",url:"https://tls-cl.cdnz.cl/radiosoberania/live/playlist.m3u8?PlaylistM3UCL",logo:"LOGOS/SOBERANIATV.png"},
{number:7,name:"Radio Ibáñez TV",type:"m3u8",url:"https://ibanez.servercl.com/hls/live.m3u8",logo:"LOGOS/RADIOIBAÑEZ.png"},
{number:8,name:"Milodón TV",type:"m3u8",url:"https://video3.servidordevideo.net:3585/live/upbsfzhdlive.m3u8",logo:"LOGOS/MILODONTV.png"},
{number:9,name:"CTV35",type:"m3u8",url:"https://vdochile.com:3697/hybrid/play.m3u8",logo:"LOGOS/CTV35.png"},
{number:10,name:"Opinión Sur TV",type:"m3u8",url:"https://stmv5.voxtvhd.com.br/opinionsur/opinionsur/playlist.m3u8?PlaylistM3UCL",logo:"LOGOS/OPINIONSURTV.png"},
{number:11,name:"UMAG TV 1",type:"m3u8",url:"https://tls-cl.cdnz.cl/umag1/ngrp:live_all/playlist.m3u8",logo:"LOGOS/UMAGTV1.png"},
{number:12,name:"UMAG TV 2",type:"m3u8",url:"https://tls-cl.cdnz.cl/umag2/live/playlist.m3u8",logo:"LOGOS/UMAGTV2.png"},
{number:13,name:"Sur TV",type:"m3u8",url:"https://redirector.rudo.video/hls-video/ey6283je82983je9823je8jowowiekldk9838274/surtv/surtv.smil/playlist.m3u8?did=",logo:"LOGOS/SURTV.png"},
{number:14,name:"Eva Visión",type:"m3u8",url:"https://stmv4.voxtvhd.com.br/evavision/evavision/playlist.m3u8",logo:"LOGOS/EVAVISION.png"},
{number:15,name:"Eva Visión Retro",type:"m3u8",url:"https://premium.tvcontrolcp.com:1936/evaretro/evaretro/playlist.m3u8",logo:"LOGOS/EVAVISIONRETRO.png"},
{number:16,name:"Patagonia TV",type:"m3u8",url:"https://videohd.live:19360/8100/8100.m3u8",logo:"LOGOS/PATAGONIATV.png"},
{number:17,name:"Canal Sur Patagonia",type:"m3u8",url:"https://v2.tustreaming.cl/fmarcoirirs/tracks-v1a1/playlist.m3u8?PlaylistM3UCL",logo:"LOGOS/CANALSURPATAGONIA.png"},
{number:18,name:"Red Fueguina",type:"m3u8",url:"https://stmv5.voxtvhd.com.br/redfueguina/redfueguina/playlist.m3u8",logo:"LOGOS/redfueguinamedios.png"},
{number:19,name:"Radio Navarino TV",type:"m3u8",url:"https://panel.tvstream.cl:1936/matxnmjryy/matxnmjryy/playlist.m3u8",logo:"LOGOS/RADIONAVARINO.png"},
{number:20,name:"EGM Channel",type:"m3u8",url:"https://vdochile.com:3922/live/egm20live.m3u8",logo:"LOGOS/EGMChannel.png"},

/* RADIOS */
{number:100,name:"Radio Sur",type:"radio",url:"https://sonicpanel.cloudstreaming.eu/8078/stream",logo:"LOGOS/RadioSur.png"},
{number:101,name:"Faraónica Natales",type:"radio",url:"https://179.9.164.55:1935/radio",logo:"LOGOS/FARAONICANATALES.png"},
{number:102,name:"Radio Meridional",type:"radio",url:"https://sonic.nnw.cl/8028/stream",logo:"LOGOS/MERIDIONAL.png"},
{number:103,name:"Patagonia Austral",type:"radio",url:"https://sonicpanel.globalstream.pro/8170/stream",logo:"LOGOS/PATAGONIAAUSTRAL.png"},
{number:104,name:"Camelot FM",type:"radio",url:"https://sonicpanel.globalstream.pro/8032/stream",logo:"LOGOS/CamelotFM.png"},
{number:105,name:"Stylo FM",type:"radio",url:"https://cdn.instream.audio/stream/stylojor",logo:"LOGOS/STYLOFM.png"},
{number:106,name:"Nuevo Día FM",type:"radio",url:"https://streaming01.shockmedia.com.ar:10791",logo:"LOGOS/NuevoDiaFMpng.png"},
{number:107,name:"Generación Retro",type:"radio",url:"https://sonic.streamingchilenos.com/9634/;",logo:"LOGOS/GENERACIONRETRO.png"},
{number:108,name:"Natalíssima",type:"radio",url:"https://sonicpanel.globalstream.pro/8246/stream",logo:"LOGOS/NATALISSIMA.png"},
{number:109,name:"Radio Cooperativa",type:"radio",url:"http://stream.cooperativa.cl/cooperativa_link.mp3",logo:"https://cdn.instant.audio/images/logos/emisora-cl/cooperativa.png"},
{number:110,name:"Carnaval FM",type:"radio",url:"https://sonando-us.digitalproserver.com/carnaval_antofagasta.aac",logo:"https://cdn.instant.audio/images/logos/emisora-cl/carnaval-vina.png"}
];

/* ===== FUNCIONES ===== */
function renderChannelList(){
  channelItems.innerHTML="";
  channels.forEach((c,i)=>{
    const div=document.createElement("div");
    div.className="channel-item"+(i===currentChannel?" active":"");
    div.innerHTML=`<img src="${c.logo}"><span>${c.number} · ${c.name}</span>`;
    channelItems.appendChild(div);
  });
  const active=document.querySelector(".channel-item.active");
  if(active) channelItems.scrollTop=active.offsetTop-channelItems.clientHeight/2;
}

function showOverlay(ch){
  overlayLogo.src=ch.logo;
  overlayName.textContent=ch.name;
  overlayNumber.textContent="Canal "+ch.number;
  overlay.classList.add("show");
  channelList.classList.add("show");
  renderChannelList();

  clearTimeout(overlayTimeout);
  clearTimeout(listTimeout);
  overlayTimeout=setTimeout(()=>overlay.classList.remove("show"),3500);
  listTimeout=setTimeout(()=>channelList.classList.remove("show"),4000);
}

function loadChannel(i){
  if(i<0) i=channels.length-1;
  if(i>=channels.length) i=0;
  currentChannel=i;
  const ch=channels[i];

  video.pause();
  video.src="";
  audioLogo.style.display="none";

  if(ch.type==="radio"){
    video.src=ch.url;
    video.play();
    audioLogo.src=ch.logo;
    audioLogo.style.display="block";
  }else if(ch.type==="video"){
    video.src=ch.url;
    video.loop=true;
    video.play();
  }else{
    if(Hls.isSupported()){
      const hls=new Hls();
      hls.loadSource(ch.url);
      hls.attachMedia(video);
    }else video.src=ch.url;
    video.play();
  }
  showOverlay(ch);
}

/* CONTROLES */
document.addEventListener("keydown",e=>{
  if(e.key==="ArrowUp") loadChannel(currentChannel-1);
  if(e.key==="ArrowDown") loadChannel(currentChannel+1);
  if(e.key==="+") video.volume=Math.min(1,video.volume+.1);
  if(e.key==="-" ) video.volume=Math.max(0,video.volume-.1);

  if(/[0-9]/.test(e.key)){
    inputNumber+=e.key;
    setTimeout(()=>{
      const idx=channels.findIndex(c=>c.number==inputNumber);
      if(idx!=-1) loadChannel(idx);
      inputNumber="";
    },800);
  }
});

/* GESTOS */
let startY=0;
document.addEventListener("touchstart",e=>startY=e.touches[0].clientY);
document.addEventListener("touchend",e=>{
  let endY=e.changedTouches[0].clientY;
  if(startY-endY>50) loadChannel(currentChannel+1);
  if(endY-startY>50) loadChannel(currentChannel-1);
});

/* INICIO */
loadChannel(0);
</script>

</body>
</html>
